{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/SignalHub/frontend/src/app/api/auth/reset-pass/send-otp/route.ts"],"sourcesContent":["// app/api/auth/forgot/send-otp/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\n/**\r\n * Mock implementation:\r\n * - Accepts { email }\r\n * - Validates email\r\n * - Generates a 6-digit OTP and stores it in a temporary in-memory map (development only).\r\n * - In production you should:\r\n *   - store OTP server-side (Redis, DB) with expiry\r\n *   - send email via SendGrid/Resend/SES etc.\r\n */\r\n\r\ntype StoredOtp = { code: string; expiresAt: number };\r\nconst OTP_STORE = (global as any).__OTP_STORE__ || ((global as any).__OTP_STORE__ = new Map<string, StoredOtp>());\r\n\r\nfunction generateOtp() {\r\n  return Math.floor(100000 + Math.random() * 900000).toString();\r\n}\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const body = await req.json();\r\n    const email = String(body?.email ?? \"\").trim().toLowerCase();\r\n\r\n    if (!email || !/^\\S+@\\S+\\.\\S+$/.test(email)) {\r\n      return NextResponse.json({ error: \"Invalid email\" }, { status: 400 });\r\n    }\r\n\r\n    // TODO: check user exists in DB. If you don't want to leak existence, always send success.\r\n    // For now we proceed.\r\n\r\n    const code = generateOtp();\r\n    const expiresAt = Date.now() + 5 * 60 * 1000; // 5 minutes\r\n    OTP_STORE.set(email, { code, expiresAt });\r\n\r\n    // TODO: send email using your provider. Here we just log for dev.\r\n    console.log(`[DEV] OTP for ${email}: ${code} (expires in 5m)`);\r\n\r\n    return NextResponse.json({ ok: true, message: \"OTP sent (dev-mode)\" }, { status: 200 });\r\n  } catch (err) {\r\n    console.error(\"send-otp error\", err);\r\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,wCAAwC;;;;;AACxC;;AAcA,MAAM,YAAY,yDAAgB,aAAa,IAAI,CAAC,yDAAgB,aAAa,GAAG,IAAI,KAAwB;AAEhH,SAAS;IACP,OAAO,KAAK,KAAK,CAAC,SAAS,KAAK,MAAM,KAAK,QAAQ,QAAQ;AAC7D;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,QAAQ,OAAO,MAAM,SAAS,IAAI,IAAI,GAAG,WAAW;QAE1D,IAAI,CAAC,SAAS,CAAC,iBAAiB,IAAI,CAAC,QAAQ;YAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QAEA,2FAA2F;QAC3F,sBAAsB;QAEtB,MAAM,OAAO;QACb,MAAM,YAAY,KAAK,GAAG,KAAK,IAAI,KAAK,MAAM,YAAY;QAC1D,UAAU,GAAG,CAAC,OAAO;YAAE;YAAM;QAAU;QAEvC,kEAAkE;QAClE,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,MAAM,EAAE,EAAE,KAAK,gBAAgB,CAAC;QAE7D,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,SAAS;QAAsB,GAAG;YAAE,QAAQ;QAAI;IACvF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}