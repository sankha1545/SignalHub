{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["E:/Attackcapital/SignalHub/frontend/src/components/modals/ConfirmModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\ntype ConfirmModalProps = {\r\n  open: boolean;\r\n  title?: string;\r\n  message?: string;\r\n  confirmLabel?: string;\r\n  cancelLabel?: string;\r\n  onConfirm: () => Promise<void> | void;\r\n  onCancel: () => void;\r\n};\r\n\r\nexport default function ConfirmModal({\r\n  open,\r\n  title = \"Confirm\",\r\n  message = \"Are you sure?\",\r\n  confirmLabel = \"Yes\",\r\n  cancelLabel = \"Cancel\",\r\n  onConfirm,\r\n  onCancel,\r\n}: ConfirmModalProps) {\r\n  const ref = useRef<HTMLDivElement | null>(null);\r\n  const primaryBtnRef = useRef<HTMLButtonElement | null>(null);\r\n\r\n  // prevent background scroll\r\n  useEffect(() => {\r\n    if (!open) return;\r\n    const prev = document.body.style.overflow;\r\n    document.body.style.overflow = \"hidden\";\r\n    primaryBtnRef.current?.focus();\r\n    return () => {\r\n      document.body.style.overflow = prev;\r\n    };\r\n  }, [open]);\r\n\r\n  // close on ESC\r\n  useEffect(() => {\r\n    function onKey(e: KeyboardEvent) {\r\n      if (e.key === \"Escape\") onCancel();\r\n    }\r\n    if (open) window.addEventListener(\"keydown\", onKey);\r\n    return () => window.removeEventListener(\"keydown\", onKey);\r\n  }, [open, onCancel]);\r\n\r\n  if (!open) return null;\r\n\r\n  return ReactDOM.createPortal(\r\n    <div\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      aria-labelledby=\"confirm-title\"\r\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\r\n    >\r\n      <div\r\n        className=\"absolute inset-0 bg-black/40 backdrop-blur-sm\"\r\n        onClick={onCancel}\r\n        aria-hidden\r\n      />\r\n      <div\r\n        ref={ref}\r\n        className=\"relative z-10 max-w-lg w-full bg-white rounded-2xl shadow-xl border p-6\"\r\n      >\r\n        <h3 id=\"confirm-title\" className=\"text-lg font-semibold text-slate-900\">\r\n          {title}\r\n        </h3>\r\n        <p className=\"mt-2 text-sm text-slate-600\">{message}</p>\r\n\r\n        <div className=\"mt-6 flex justify-end gap-3\">\r\n          <button\r\n            onClick={onCancel}\r\n            className=\"px-4 py-2 rounded-lg border text-sm text-slate-700 hover:bg-slate-50\"\r\n          >\r\n            {cancelLabel}\r\n          </button>\r\n          <button\r\n            ref={primaryBtnRef}\r\n            onClick={() => void onConfirm()}\r\n            className=\"px-4 py-2 rounded-lg bg-red-600 text-white text-sm hover:opacity-95\"\r\n          >\r\n            {confirmLabel}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>,\r\n    document.body\r\n  );\r\n}\r\n"],"names":["c","_c","React","useEffect","useRef","ReactDOM","ConfirmModalProps","open","title","message","confirmLabel","cancelLabel","onConfirm","Promise","onCancel","ConfirmModal","t0","$","$i","Symbol","for","t1","t2","t3","t4","undefined","ref","primaryBtnRef","t5","t6","ConfirmModal[useEffect()]","prev","document","body","style","overflow","current","focus","t7","t8","onKey","e","key","window","addEventListener","removeEventListener","t9","t10","t11","t12","t13","t14","ConfirmModal[<button>.onClick]","t15","t16","t17","t18","createPortal"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 274, "column": 0}, "map": {"version":3,"sources":["E:/Attackcapital/SignalHub/frontend/src/components/profile/ProfileMenu.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport ConfirmModal from \"../modals/ConfirmModal\";\r\n\r\nexport default function ProfileMenu({ avatarUrl, email }: { avatarUrl?: string; email?: string }) {\r\n  const router = useRouter();\r\n  const [open, setOpen] = useState(false);\r\n  const [confirmOpen, setConfirmOpen] = useState(false);\r\n  const [loggingOut, setLoggingOut] = useState(false);\r\n  const menuRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // close on outside click\r\n  useEffect(() => {\r\n    function onDocClick(e: MouseEvent) {\r\n      if (!menuRef.current) return;\r\n      if (!(e.target instanceof Node)) return;\r\n      if (!menuRef.current.contains(e.target)) setOpen(false);\r\n    }\r\n    document.addEventListener(\"mousedown\", onDocClick);\r\n    return () => document.removeEventListener(\"mousedown\", onDocClick);\r\n  }, []);\r\n\r\n  // keyboard support\r\n  useEffect(() => {\r\n    function onKey(e: KeyboardEvent) {\r\n      if (e.key === \"Escape\") setOpen(false);\r\n    }\r\n    if (open) window.addEventListener(\"keydown\", onKey);\r\n    return () => window.removeEventListener(\"keydown\", onKey);\r\n  }, [open]);\r\n\r\n  async function handleLogout() {\r\n    try {\r\n      setLoggingOut(true);\r\n      const res = await fetch(\"/api/auth/logout\", { method: \"POST\" });\r\n      // ignore body; route clears cookie\r\n      setConfirmOpen(false);\r\n      setOpen(false);\r\n      // redirect to login page\r\n      router.replace(\"/auth/login\");\r\n    } catch (err) {\r\n      console.error(\"Logout failed\", err);\r\n      setLoggingOut(false);\r\n      setConfirmOpen(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative\" ref={menuRef}>\r\n      <button\r\n        aria-haspopup=\"menu\"\r\n        aria-expanded={open}\r\n        onClick={() => setOpen((v) => !v)}\r\n        className=\"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center shadow-sm hover:opacity-95\"\r\n        title=\"Account menu\"\r\n      >\r\n        {avatarUrl ? (\r\n          <img src={avatarUrl} alt=\"avatar\" className=\"w-10 h-10 rounded-full object-cover\" />\r\n        ) : (\r\n          <span className=\"text-sm font-medium text-slate-700\">{(email || \"U\").charAt(0).toUpperCase()}</span>\r\n        )}\r\n      </button>\r\n\r\n      {open && (\r\n        <div\r\n          role=\"menu\"\r\n          aria-label=\"Profile\"\r\n          className=\"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border py-2 z-20\"\r\n        >\r\n          <button\r\n            role=\"menuitem\"\r\n            onClick={() => {\r\n              setOpen(false);\r\n              router.push(\"/profile\");\r\n            }}\r\n            className=\"w-full text-left px-3 py-2 hover:bg-slate-50 text-sm text-slate-700\"\r\n          >\r\n            View profile\r\n          </button>\r\n\r\n          <button\r\n            role=\"menuitem\"\r\n            onClick={() => {\r\n              setConfirmOpen(true);\r\n            }}\r\n            className=\"w-full text-left px-3 py-2 hover:bg-slate-50 text-sm text-slate-700\"\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      <ConfirmModal\r\n        open={confirmOpen}\r\n        title=\"Log out?\"\r\n        message=\"Do you want to logout?\"\r\n        confirmLabel={loggingOut ? \"Logging out...\" : \"Yes, log out\"}\r\n        cancelLabel=\"Cancel\"\r\n        onCancel={() => setConfirmOpen(false)}\r\n        onConfirm={async () => {\r\n          await handleLogout();\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["c","_c","React","useEffect","useRef","useState","useRouter","ConfirmModal","ProfileMenu","t0","$","$i","Symbol","for","avatarUrl","email","router","open","setOpen","confirmOpen","setConfirmOpen","loggingOut","setLoggingOut","menuRef","t1","t2","ProfileMenu[useEffect()]","onDocClick","e","current","target","Node","contains","document","addEventListener","removeEventListener","t3","t4","onKey","e_0","key","window","t5","handleLogout","fetch","method","replace","t6","err","console","error","ProfileMenu[<button>.onClick]","_ProfileMenuButtonOnClickSetOpen","t7","charAt","toUpperCase","t8","t9","push","t10","t11","ProfileMenu[<ConfirmModal>.onCancel]","t12","ProfileMenu[<ConfirmModal>.onConfirm]","t13","t14","v"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 572, "column": 0}, "map": {"version":3,"sources":["E:/Attackcapital/SignalHub/frontend/src/app/welcome/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport ProfileMenu from \"@/components/profile/ProfileMenu\";\r\nimport * as Y from \"yjs\";\r\nimport { WebsocketProvider } from \"y-websocket\";\r\n\r\n/**\r\n * WelcomePage (rewritten)\r\n *\r\n * Changes:\r\n * - Composer's \"To\" is now a selection based on verified contacts/emails.\r\n * - Contacts loaded from /api/contacts (fallback /api/users).\r\n * - Filtering by channel: SMS/WHATSAPP -> phones only, EMAIL -> emails only.\r\n *\r\n * Server endpoints expected (unchanged except contact list):\r\n * - POST /api/messages/send\r\n * - POST /api/messages/schedule\r\n * - GET  /api/contacts/:id\r\n * - GET  /api/contacts/:id/notes\r\n * - POST /api/contacts/:id/notes\r\n * - GET  /api/threads?limit=...\r\n * - GET  /api/twilio/numbers\r\n * - POST /api/twilio/buy\r\n * - WS   /api/ws\r\n * - Yjs WS at NEXT_PUBLIC_YJS_WS\r\n */\r\n\r\ntype Role = \"VIEWER\" | \"EDITOR\" | \"ADMIN\" | string;\r\n\r\ntype User = {\r\n  id: string;\r\n  email: string;\r\n  name?: string;\r\n  role?: Role;\r\n  tenantId?: string | null;\r\n};\r\n\r\ntype AnalyticsSummary = {\r\n  messages7d: number;\r\n  avgResponseMins: number;\r\n  openRatePct: number;\r\n  sparkline: number[];\r\n};\r\n\r\ntype ThreadPreviewItem = {\r\n  id: string;\r\n  contactId?: string;\r\n  contactName: string;\r\n  contactPhone?: string;\r\n  channels: string[];\r\n  snippet: string;\r\n  lastAt: string; // ISO\r\n  unreadCount?: number;\r\n  status?: string;\r\n  scheduled?: boolean;\r\n};\r\n\r\ntype ProviderNumber = {\r\n  id: string;\r\n  phone: string;\r\n  provider: string;\r\n  capabilities?: Record<string, boolean>;\r\n  purchased: boolean;\r\n};\r\n\r\ntype ContactItem = {\r\n  id: string;\r\n  name?: string | null;\r\n  email?: string | null;\r\n  emailVerified?: boolean;\r\n  phone?: string | null; // E.164\r\n  phoneVerified?: boolean;\r\n};\r\n\r\n/* ----------------------------- Page ---------------------------- */\r\n\r\nexport default function WelcomePage() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [analytics, setAnalytics] = useState<AnalyticsSummary | null>(null);\r\n  const [threads, setThreads] = useState<ThreadPreviewItem[]>([]);\r\n  const [numbers, setNumbers] = useState<ProviderNumber[]>([]);\r\n\r\n  // NEW: contacts list used for composer \"To\" selection\r\n  const [contacts, setContacts] = useState<ContactItem[]>([]);\r\n\r\n  const [composerOpen, setComposerOpen] = useState(false);\r\n  const [composerContext, setComposerContext] = useState<{ threadId?: string; contactId?: string } | null>(null);\r\n  const [contactModal, setContactModal] = useState<{ contactId: string } | null>(null);\r\n  const [buying, setBuying] = useState<string | null>(null);\r\n\r\n  const [presence, setPresence] = useState<Record<string, { name?: string; idle?: boolean }>>({});\r\n\r\n  const wsRef = useRef<WebSocket | null>(null);\r\n\r\n  // Derived role helpers\r\n  const role = (user?.role ?? \"VIEWER\").toString().toUpperCase();\r\n  const isAdmin = role === \"ADMIN\";\r\n  const isEditor = role === \"EDITOR\" || isAdmin;\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    const controller = new AbortController();\r\n    const signal = controller.signal;\r\n\r\n    async function loadAll() {\r\n      setLoading(true);\r\n      try {\r\n        const [meRes, analyticsRes, threadsRes, numbersRes] = await Promise.all([\r\n          fetch(`/api/me`, { signal }),\r\n          fetch(`/api/analytics/summary`, { signal }),\r\n          fetch(`/api/threads?limit=10`, { signal }),\r\n          fetch(`/api/twilio/numbers`, { signal }),\r\n        ]);\r\n\r\n        if (!mounted) return;\r\n\r\n        // /api/me\r\n        if (meRes.ok) {\r\n          try {\r\n            const j = await meRes.json();\r\n            setUser(j.user ?? null);\r\n          } catch (err) {\r\n            console.warn(\"welcome: /api/me parse error\", err);\r\n            setUser(null);\r\n          }\r\n        } else {\r\n          setUser(null);\r\n        }\r\n\r\n        // analytics\r\n        if (analyticsRes.ok) {\r\n          try {\r\n            const j = await analyticsRes.json();\r\n            setAnalytics({\r\n              messages7d: j.messages7d ?? 0,\r\n              avgResponseMins: j.avgResponseMins ?? 0,\r\n              openRatePct: j.openRatePct ?? 0,\r\n              sparkline: Array.isArray(j.sparkline) && j.sparkline.length ? j.sparkline : [1, 2, 3, 2, 4],\r\n            });\r\n          } catch (e) {\r\n            console.warn(\"welcome: analytics parse error\", e);\r\n            setAnalytics(null);\r\n          }\r\n        }\r\n\r\n        // threads\r\n        if (threadsRes.ok) {\r\n          try {\r\n            const j = await threadsRes.json();\r\n            setThreads(Array.isArray(j.threads) ? j.threads : []);\r\n          } catch (e) {\r\n            console.warn(\"welcome: threads parse error\", e);\r\n            setThreads([]);\r\n          }\r\n        }\r\n\r\n        // numbers\r\n        if (numbersRes.ok) {\r\n          try {\r\n            const j = await numbersRes.json();\r\n            setNumbers(Array.isArray(j.numbers) ? j.numbers : []);\r\n          } catch (e) {\r\n            console.warn(\"welcome: numbers parse error\", e);\r\n            setNumbers([]);\r\n          }\r\n        }\r\n\r\n        // load contacts list for composer (best-effort)\r\n        try {\r\n          await fetchContacts(signal);\r\n        } catch (err) {\r\n          console.warn(\"welcome: fetchContacts failed\", err);\r\n        }\r\n      } catch (e) {\r\n        if ((e as any).name === \"AbortError\") {\r\n          // expected on unmount\r\n        } else {\r\n          console.error(\"welcome: loadAll error\", e);\r\n        }\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n\r\n    loadAll();\r\n\r\n    return () => {\r\n      mounted = false;\r\n      controller.abort();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  // Fetch contacts list (prefers /api/contacts, fallback to /api/users)\r\n // Replace existing fetchContacts with this more robust version\r\nasync function fetchContacts(signal?: AbortSignal | null) {\r\n  const tried: string[] = [];\r\n\r\n  // helper: normalize a raw user/contact object into ContactItem shape\r\n  function normalizeRaw(raw: any): ContactItem | null {\r\n    if (!raw) return null;\r\n    // try many common locations for id/name/email/phone and verified flags\r\n    const id = raw.id ?? raw.userId ?? raw.contactId ?? raw._id ?? null;\r\n    const name =\r\n      raw.name ??\r\n      raw.displayName ??\r\n      raw.fullName ??\r\n      (raw.profile && (raw.profile.displayName || raw.profile.name)) ??\r\n      raw.email ??\r\n      null;\r\n\r\n    // find email in several shapes\r\n    let email: string | null = null;\r\n    let emailVerified = false;\r\n    if (raw.email) {\r\n      email = raw.email;\r\n      // common boolean flag\r\n      emailVerified = Boolean(raw.emailVerified ?? raw.email_verified ?? (raw.profile && raw.profile.emailVerified) ?? false);\r\n    } else if (Array.isArray(raw.emails) && raw.emails.length) {\r\n      // e.g. [{ value:'x@', verified: true }]\r\n      const primary = raw.emails.find((e: any) => e.primary || e.primary === true) ?? raw.emails[0];\r\n      email = primary?.value ?? primary?.address ?? null;\r\n      emailVerified = Boolean(primary?.verified ?? primary?.verifiedAt ?? false);\r\n    } else if (Array.isArray(raw.accounts) && raw.accounts.length) {\r\n      // e.g. OAuth accounts [{ provider: 'google', email: 'x@' }]\r\n      const acct = raw.accounts.find((a: any) => a.provider && (a.email || a.profile?.email)) ?? raw.accounts[0];\r\n      email = acct?.email ?? acct?.profile?.email ?? null;\r\n      emailVerified = true; // assume oauth provider emails are verified\r\n    } else if (Array.isArray(raw.identities) && raw.identities.length) {\r\n      const idn = raw.identities.find(Boolean);\r\n      email = idn?.email ?? null;\r\n      emailVerified = Boolean(idn?.email_verified ?? true);\r\n    } else if (raw.profile && raw.profile.email) {\r\n      email = raw.profile.email;\r\n      emailVerified = Boolean(raw.profile.emailVerified ?? raw.profile.email_verified ?? false);\r\n    }\r\n\r\n    // find phone in several shapes\r\n    let phone: string | null = null;\r\n    let phoneVerified = false;\r\n    if (raw.phone) {\r\n      phone = raw.phone;\r\n      phoneVerified = Boolean(raw.phoneVerified ?? raw.phone_verified ?? (raw.profile && raw.profile.phoneVerified) ?? false);\r\n    } else if (raw.phoneNumber) {\r\n      phone = raw.phoneNumber;\r\n      phoneVerified = Boolean(raw.phoneVerified ?? false);\r\n    } else if (raw.profile && raw.profile.phoneNumber) {\r\n      phone = raw.profile.phoneNumber;\r\n      phoneVerified = Boolean(raw.profile.phoneVerified ?? false);\r\n    } else if (Array.isArray(raw.phones) && raw.phones.length) {\r\n      const p = raw.phones[0];\r\n      phone = p?.value ?? p?.number ?? null;\r\n      phoneVerified = Boolean(p?.verified ?? false);\r\n    }\r\n\r\n    if (!id && !email && !phone) {\r\n      // nothing useful here\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      id: id ?? (email ?? phone) ?? String(Math.random()).slice(2, 9),\r\n      name,\r\n      email,\r\n      emailVerified,\r\n      phone,\r\n      phoneVerified,\r\n    };\r\n  }\r\n\r\n  // generic fetch helper that returns array or object\r\n  async function tryFetch(url: string) {\r\n    tried.push(url);\r\n    try {\r\n      const opts = signal ? { signal } : undefined;\r\n      const r = await fetch(url, opts as any);\r\n      if (!r.ok) {\r\n        console.debug(`[fetchContacts] ${url} returned ${r.status}`);\r\n        return null;\r\n      }\r\n      const j = await r.json().catch(() => null);\r\n      return j;\r\n    } catch (err) {\r\n      console.debug(`[fetchContacts] ${url} fetch error:`, err);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // order: contacts -> users -> me -> admin/users\r\n  const tries = [\"/api/contacts?limit=1000\", \"/api/users?limit=1000\", \"/api/me\", \"/api/admin/users?limit=1000\"];\r\n  let aggregated: any[] = [];\r\n\r\n  for (const url of tries) {\r\n    const data = await tryFetch(url);\r\n    if (!data) continue;\r\n\r\n    // /api/me returns { user }\r\n    if (data.user) {\r\n      const n = normalizeRaw(data.user);\r\n      if (n) aggregated.push(n);\r\n    } else if (Array.isArray(data)) {\r\n      for (const item of data) {\r\n        const n = normalizeRaw(item);\r\n        if (n) aggregated.push(n);\r\n      }\r\n    } else if (Array.isArray(data.contacts)) {\r\n      for (const item of data.contacts) {\r\n        const n = normalizeRaw(item);\r\n        if (n) aggregated.push(n);\r\n      }\r\n    } else if (Array.isArray((data as any).users)) {\r\n      for (const item of (data as any).users) {\r\n        const n = normalizeRaw(item);\r\n        if (n) aggregated.push(n);\r\n      }\r\n    } else if (typeof data === \"object\") {\r\n      // maybe it's a single user or object with items\r\n      if ((data as any).items && Array.isArray((data as any).items)) {\r\n        for (const item of (data as any).items) {\r\n          const n = normalizeRaw(item);\r\n          if (n) aggregated.push(n);\r\n        }\r\n      } else {\r\n        // single object\r\n        const n = normalizeRaw(data);\r\n        if (n) aggregated.push(n);\r\n      }\r\n    }\r\n\r\n    // if we found some items, break early (but still allow later fallback)\r\n    if (aggregated.length > 0) break;\r\n  }\r\n\r\n  // always also try to include the signed-in /api/me user to ensure they're visible\r\n  try {\r\n    const me = await tryFetch(\"/api/me\");\r\n    if (me && me.user) {\r\n      const n = normalizeRaw(me.user);\r\n      if (n) aggregated.push(n);\r\n    }\r\n  } catch (e) {}\r\n\r\n  // de-duplicate by id/email/phone\r\n  const map = new Map<string, ContactItem>();\r\n  for (const a of aggregated) {\r\n    const key = a.id ?? a.email ?? a.phone ?? JSON.stringify(a);\r\n    if (!map.has(key)) map.set(key, a);\r\n    else {\r\n      // merge existing\r\n      const ex = map.get(key)!;\r\n      map.set(key, { ...ex, ...a });\r\n    }\r\n  }\r\n\r\n  const result = Array.from(map.values());\r\n\r\n  // debug: if empty, log what we tried to help backend debugging\r\n  if (result.length === 0) {\r\n    console.warn(\"[fetchContacts] no contacts normalized — tried endpoints:\", tried);\r\n    console.warn(\"[fetchContacts] aggregated raw:\", aggregated.slice(0, 20));\r\n  } else {\r\n    console.debug(\"[fetchContacts] normalized contacts count:\", result.length);\r\n  }\r\n\r\n  setContacts((prev) => mergeUniqueContacts(prev, result));\r\n}\r\n\r\n\r\n  function mergeUniqueContacts(prev: ContactItem[], next: ContactItem[]) {\r\n    const map = new Map<string, ContactItem>();\r\n    // key by id primarily, else by email/phone\r\n    prev.forEach((c) => {\r\n      const key = c.id ?? c.email ?? c.phone ?? String(Math.random());\r\n      map.set(key, c);\r\n    });\r\n    next.forEach((c) => {\r\n      const key = c.id ?? c.email ?? c.phone ?? String(Math.random());\r\n      if (!map.has(key)) map.set(key, c);\r\n      else {\r\n        const existing = map.get(key)!;\r\n        map.set(key, { ...existing, ...c });\r\n      }\r\n    });\r\n    return Array.from(map.values());\r\n  }\r\n\r\n  // Realtime: open WebSocket to receive presence and new thread events\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    let ws: WebSocket | null = null;\r\n    try {\r\n      ws = new WebSocket((typeof window !== \"undefined\" ? window.location.origin : \"\") + \"/api/ws\");\r\n      wsRef.current = ws;\r\n\r\n      ws.onopen = () => {\r\n        ws?.send(JSON.stringify({ type: \"hello\", userId: user.id, name: user.name }));\r\n      };\r\n\r\n      ws.onmessage = (ev) => {\r\n        try {\r\n          const msg = JSON.parse(ev.data);\r\n          if (msg.type === \"presence\") {\r\n            setPresence((p) => ({ ...p, [msg.userId]: { name: msg.name, idle: msg.idle } }));\r\n          }\r\n          if (msg.type === \"presence:leave\") {\r\n            setPresence((p) => {\r\n              const copy = { ...p };\r\n              delete copy[msg.userId];\r\n              return copy;\r\n            });\r\n          }\r\n          if (msg.type === \"thread:new\") {\r\n            setThreads((t) => [msg.thread as ThreadPreviewItem, ...t]);\r\n          }\r\n          if (msg.type === \"thread:update\") {\r\n            setThreads((t) => t.map((x) => (x.id === msg.thread.id ? msg.thread : x)));\r\n          }\r\n        } catch (e) {\r\n          console.warn(\"ws parse error\", e);\r\n        }\r\n      };\r\n\r\n      ws.onclose = () => {\r\n        wsRef.current = null;\r\n      };\r\n    } catch (e) {\r\n      console.warn(\"Realtime not available\", e);\r\n    }\r\n\r\n    return () => {\r\n      try {\r\n        ws?.close();\r\n      } catch (e) {\r\n        /* */\r\n      }\r\n    };\r\n  }, [user]);\r\n\r\n  function handlePrimary() {\r\n    if (isAdmin) router.push(\"/admin\");\r\n    else router.push(\"/inbox\");\r\n  }\r\n\r\n  async function handleBuyNumber(id: string) {\r\n    setBuying(id);\r\n    try {\r\n      const res = await fetch(`/api/twilio/buy`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ id }),\r\n      });\r\n      if (!res.ok) throw new Error(\"failed to buy\");\r\n      // refresh numbers\r\n      const refreshed = await fetch(`/api/twilio/numbers`);\r\n      if (refreshed.ok) {\r\n        const j = await refreshed.json();\r\n        setNumbers(Array.isArray(j.numbers) ? j.numbers : []);\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(\"Failed to buy number. Check logs or sandbox mode.\");\r\n    } finally {\r\n      setBuying(null);\r\n    }\r\n  }\r\n\r\n  // open composer with optional context (threadId or contactId)\r\n  function openComposer(ctx?: { threadId?: string; contactId?: string }) {\r\n    if (!isEditor) {\r\n      // viewers cannot compose\r\n      return;\r\n    }\r\n    setComposerContext(ctx ?? null);\r\n    setComposerOpen(true);\r\n  }\r\n\r\n  function closeComposer() {\r\n    setComposerOpen(false);\r\n    setComposerContext(null);\r\n  }\r\n\r\n  // sendMessage handles immediate sends and scheduled sends\r\n  // improved sendMessage with detailed logging & clearer errors\r\nasync function sendMessage(payload: { to: string; channel: string; body: string; scheduleAt?: string; threadId?: string; contactId?: string }) {\r\n  if (!isEditor) throw new Error(\"not authorized\");\r\n\r\n  console.debug(\"[sendMessage] payload:\", payload);\r\n\r\n  // optimistic thread preview insertion (unchanged)\r\n  const isScheduled = !!payload.scheduleAt;\r\n  const optimistic: ThreadPreviewItem = {\r\n    id: isScheduled ? \"sched-\" + Math.random().toString(36).slice(2, 9) : \"tmp-\" + Math.random().toString(36).slice(2, 9),\r\n    contactId: payload.contactId,\r\n    contactName: payload.to,\r\n    contactPhone: payload.to,\r\n    channels: [payload.channel],\r\n    snippet: payload.body,\r\n    lastAt: new Date().toISOString(),\r\n    scheduled: isScheduled,\r\n  };\r\n  setThreads((t) => [optimistic, ...t]);\r\n\r\n  try {\r\n    let res: Response;\r\n    let endpoint: string;\r\n    if (isScheduled) {\r\n      endpoint = \"/api/messages/schedule\";\r\n      res = await fetch(endpoint, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          to: payload.to,\r\n          channel: payload.channel,\r\n          body: payload.body,\r\n          sendAt: payload.scheduleAt,\r\n          threadId: payload.threadId,\r\n          contactId: payload.contactId,\r\n          metadata: { to: payload.to },\r\n        }),\r\n      });\r\n    } else {\r\n      endpoint = \"/api/messages/send\";\r\n      res = await fetch(endpoint, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          to: payload.to,\r\n          channel: payload.channel,\r\n          body: payload.body,\r\n          threadId: payload.threadId,\r\n          contactId: payload.contactId,\r\n          metadata: { to: payload.to },\r\n        }),\r\n      });\r\n    }\r\n\r\n    // read response text for debugging (attempt json, fallback to text)\r\n    const text = await res.text().catch(() => \"\");\r\n    let parsed: any = null;\r\n    try {\r\n      parsed = text ? JSON.parse(text) : null;\r\n    } catch (e) {\r\n      parsed = text;\r\n    }\r\n\r\n    console.debug(`[sendMessage] ${endpoint} responded status=${res.status}`, parsed);\r\n\r\n    if (!res.ok) {\r\n      // remove optimistic preview\r\n      setThreads((t) => t.filter((x) => !x.id.startsWith(\"tmp-\") && !x.id.startsWith(\"sched-\")));\r\n      const serverMsg = parsed?.error ?? parsed?.message ?? (typeof parsed === \"string\" ? parsed : `HTTP ${res.status}`);\r\n      // show a helpful alert and throw the server message so UI caller can react\r\n      alert(`Send failed: ${serverMsg}`);\r\n      throw new Error(`send failed: ${serverMsg}`);\r\n    }\r\n\r\n    const j = parsed ?? {};\r\n\r\n    // if server returns canonical thread, replace optimistic\r\n    if (j.thread && j.thread.id) {\r\n      setThreads((t) => [j.thread as ThreadPreviewItem, ...t.filter((x) => !x.id.startsWith(\"tmp-\") && !x.id.startsWith(\"sched-\"))]);\r\n    } else {\r\n      // fallback: remove tmp optimistic\r\n      setThreads((t) => t.filter((x) => !x.id.startsWith(\"tmp-\")));\r\n    }\r\n\r\n    return j;\r\n  } catch (err) {\r\n    // already removed optimistic on non-ok responses; ensure optimistic removed on any thrown error\r\n    setThreads((t) => t.filter((x) => !x.id.startsWith(\"tmp-\") && !x.id.startsWith(\"sched-\")));\r\n    console.error(\"[sendMessage] error:\", err);\r\n    throw err;\r\n  }\r\n}\r\n\r\n\r\n  return (\r\n    \r\n    <main className=\"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50\">\r\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\r\n        {/* Back button — navigates to the welcome page */}\r\n\r\n\r\n        {/* header */}\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"h-12 w-12 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center shadow-md\">\r\n              <svg width=\"26\" height=\"26\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden>\r\n                <path d=\"M3 12h18\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" />\r\n                <path d=\"M7 6v12\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" />\r\n              </svg>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-lg font-semibold text-slate-900\">SignalHub</div>\r\n              <div className=\"text-xs text-slate-500\">Unified Inbox • Multi-channel outreach</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"hidden sm:inline-flex items-center gap-2 rounded-full px-3 py-1 bg-slate-100 text-slate-800 text-sm\">\r\n              <strong className=\"uppercase\">{role}</strong>\r\n              <span className=\"text-xs text-slate-600\">access</span>\r\n            </div>\r\n\r\n            <div className=\"hidden md:flex items-center gap-2 text-xs text-slate-600\">\r\n              {/* presence */}\r\n              <div className=\"flex items-center gap-2\">\r\n                {Object.keys(presence).length === 0 ? (\r\n                  <span className=\"text-xs text-slate-400\">no one online</span>\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    {Object.entries(presence).slice(0, 4).map(([id, p]) => (\r\n                      <div key={id} className=\"flex items-center gap-1\">\r\n                        <span className={`w-2 h-2 rounded-full ${p.idle ? \"bg-yellow-400\" : \"bg-green-400\"}`} />\r\n                        <span title={p.name}>{p.name ?? id}</span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <ProfileMenu email={user?.email} avatarUrl={undefined} />\r\n          </div>\r\n        </div>\r\n\r\n        {/* hero + features */}\r\n        <header className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 items-start mb-8\">\r\n          <div className=\"lg:col-span-2\">\r\n            <div className=\"bg-white/60 backdrop-blur-md rounded-3xl p-8 shadow-lg border border-slate-100\">\r\n              <div className=\"flex items-start gap-6\">\r\n                <div className=\"flex-shrink-0\">\r\n                  <div className=\"h-14 w-14 rounded-xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center shadow-md\">\r\n                    <svg width=\"28\" height=\"28\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden>\r\n                      <path d=\"M3 12h18\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" />\r\n                      <path d=\"M7 6v12\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" />\r\n                    </svg>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex-1\">\r\n                  <h1 className=\"text-3xl sm:text-4xl font-extrabold tracking-tight text-slate-900\">\r\n                    SignalHub — Unified Inbox for Multi-Channel Outreach\r\n                  </h1>\r\n                  <p className=\"mt-3 text-slate-600 max-w-2xl\">\r\n                    Manage SMS, WhatsApp and Email threads in one place, collaborate with your team in\r\n                    real time, schedule messages, and measure impact — built with secure webhooks and\r\n                    role-based controls.\r\n                  </p>\r\n\r\n                  <div className=\"mt-6 flex flex-wrap gap-3 items-center\">\r\n                    <button\r\n    type=\"button\"\r\n    onClick={handlePrimary}\r\n    className=\"inline-flex items-center gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:scale-[1.01] transition-transform\"\r\n  >\r\n    {isAdmin ? \"Open Admin Dashboard\" : \"Go to Inbox\"}\r\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\">\r\n      <path d=\"M5 12h14\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\r\n      <path d=\"M12 5l7 7-7 7\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\r\n    </svg>\r\n  </button>\r\n\r\n                    <Link href=\"/settings\" className=\"px-4 py-2 rounded-lg border text-slate-700 hover:bg-slate-50\">\r\n                      Configure Integrations\r\n                    </Link>\r\n\r\n                    {isEditor && (\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => openComposer()}\r\n                        className=\"px-4 py-2 rounded-lg border bg-white text-slate-700 hover:bg-slate-50\"\r\n                      >\r\n                        Quick Compose\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* quick feature cards */}\r\n              <div className=\"mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3\">\r\n                <FeatureCard\r\n                  title=\"Unified Threads\"\r\n                  desc=\"All messages normalized into threads per contact — SMS, WhatsApp, Email. Click a thread to preview.\"\r\n                />\r\n                <FeatureCard\r\n                  title=\"Schedule & Automate\"\r\n                  desc=\"Schedule outbound messages and run background workers for timed delivery.\"\r\n                />\r\n                <FeatureCard\r\n                  title=\"Team Collaboration\"\r\n                  desc=\"Real-time presence, shared notes, and role-based permissions.\"\r\n                />\r\n                <FeatureCard\r\n                  title=\"Analytics\"\r\n                  desc=\"Quick insights: volume, response time and delivery KPIs. Exportable CSVs.\"\r\n                />\r\n              </div>\r\n\r\n              {/* twilio sandbox status + numbers */}\r\n              <div className=\"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div className=\"rounded-xl border border-rose-50 p-4 bg-rose-50/30\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <div className=\"text-sm font-semibold\">Twilio Sandbox</div>\r\n                      <div className=\"text-xs text-slate-600\">Trial mode — numbers are simulated unless purchased</div>\r\n                    </div>\r\n                    <div className=\"text-xs text-slate-500\">Sandbox</div>\r\n                  </div>\r\n\r\n                  <div className=\"mt-3\">\r\n                    <div className=\"text-xs text-slate-700 mb-2\">Available numbers</div>\r\n                    <div className=\"space-y-2\">\r\n                      {numbers.length === 0 ? (\r\n                        <div className=\"text-xs text-slate-500\">No sandbox numbers found.</div>\r\n                      ) : (\r\n                        numbers.slice(0, 4).map((n) => (\r\n                          <div key={n.id} className=\"flex items-center justify-between bg-white rounded-lg p-2 border\">\r\n                            <div>\r\n                              <div className=\"font-medium\">{n.phone}</div>\r\n                              <div className=\"text-xs text-slate-500\">\r\n                                {n.provider} • {n.capabilities ? Object.keys(n.capabilities).filter((k) => n.capabilities?.[k]).join(\", \") : \"—\"}\r\n                              </div>\r\n                            </div>\r\n                            <div>\r\n                              {n.purchased ? (\r\n                                <span className=\"text-xs text-green-600\">Purchased</span>\r\n                              ) : (\r\n                                <button\r\n                                  type=\"button\"\r\n                                  onClick={() => handleBuyNumber(n.id)}\r\n                                  className=\"px-3 py-1 rounded bg-indigo-600 text-white text-xs\"\r\n                                  disabled={!!buying}\r\n                                >\r\n                                  {buying === n.id ? \"Buying…\" : \"Buy Now\"}\r\n                                </button>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        ))\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <IntegrationsPanel numbers={numbers} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* right column: analytics + quick stats */}\r\n          <aside className=\"space-y-4\">\r\n            <AnalyticsPanel analytics={analytics} loading={loading} />\r\n\r\n            {/* Quick actions card */}\r\n            <div className=\"bg-white rounded-2xl p-4 shadow-sm border border-slate-100\">\r\n              <h4 className=\"text-sm font-semibold text-slate-700 mb-2\">Quick actions</h4>\r\n              <div className=\"flex flex-col gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  className={`text-left px-3 py-2 rounded-lg ${isEditor ? \"bg-blue-50\" : \"bg-slate-50 text-slate-500 cursor-not-allowed\"}`}\r\n                  onClick={() => (isEditor ? openComposer() : null)}\r\n                  aria-disabled={!isEditor}\r\n                >\r\n                  Compose message {isEditor ? \"\" : \"(editor required)\"}\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  className={`text-left px-3 py-2 rounded-lg ${isAdmin ? \"bg-indigo-50\" : \"bg-slate-50 text-slate-500 cursor-not-allowed\"}`}\r\n                  onClick={() => (isAdmin ? router.push(\"/admin\") : null)}\r\n                  aria-disabled={!isAdmin}\r\n                >\r\n                  Manage team {isAdmin ? \"\" : \"(admin only)\"}\r\n                </button>\r\n                <Link className=\"text-left px-3 py-2 rounded-lg bg-slate-50\" href=\"/analytics\">\r\n                  View analytics\r\n                </Link>\r\n                <Link className=\"text-left px-3 py-2 rounded-lg bg-slate-50\" href=\"/settings\">\r\n                  Integrations & webhooks\r\n                </Link>\r\n              </div>\r\n            </div>\r\n          </aside>\r\n        </header>\r\n\r\n        {/* middle: thread preview + tasks */}\r\n        <section className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          <div className=\"lg:col-span-2 bg-white rounded-3xl p-6 shadow border border-slate-100\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h2 className=\"text-lg font-semibold\">Live thread preview</h2>\r\n              <div className=\"text-sm text-slate-500\">Normalized view • unified timeline</div>\r\n            </div>\r\n\r\n            <div className=\"rounded-xl overflow-hidden border border-slate-100\">\r\n              <div className=\"p-4 bg-gradient-to-r from-slate-50 to-white\">\r\n                <ThreadsList\r\n                  threads={threads}\r\n                  onOpenContact={(id) => setContactModal({ contactId: id })}\r\n                  onCompose={(t) => openComposer({ threadId: t?.id, contactId: t?.contactId })}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-6 text-sm text-slate-600\">\r\n              This preview demonstrates how inbound messages from different channels are shown\r\n              as one thread per contact. The composer is role-gated — viewers can only\r\n              read, editors can send/schedule, admins can manage settings & team.\r\n            </div>\r\n          </div>\r\n\r\n          <aside className=\"bg-white rounded-3xl p-6 shadow border border-slate-100\">\r\n            <h3 className=\"text-sm font-semibold mb-3\">Get started — suggested next steps</h3>\r\n\r\n            <ol className=\"text-sm space-y-3 list-decimal list-inside text-slate-700\">\r\n              <li>\r\n                Open <Link href=\"/inbox\" className=\"text-blue-600\">Inbox</Link> and review threads.\r\n              </li>\r\n              <li>{isEditor ? \"Compose and schedule a test message.\" : \"Request editor access to send messages.\"}</li>\r\n              <li>Verify Twilio Sandbox under <Link href=\"/settings\" className=\"text-blue-600\">Settings</Link>.</li>\r\n              <li>{isAdmin ? <><Link href=\"/admin\" className=\"text-blue-600\">Manage team</Link> & set roles.</> : \"Ask an admin to add you to a team.\"}</li>\r\n              <li>Open <Link href=\"/analytics\" className=\"text-blue-600\">Analytics</Link> to review KPIs.</li>\r\n            </ol>\r\n\r\n            <div className=\"mt-6\">\r\n              <Link href=\"/inbox\" className=\"block text-center bg-blue-600 text-white px-4 py-2 rounded-lg\">\r\n                Start working\r\n              </Link>\r\n            </div>\r\n          </aside>\r\n        </section>\r\n\r\n        <footer className=\"mt-12 text-center text-sm text-slate-500\">\r\n          Built for the Attack Capital assignment — multi-channel outreach, scheduling, team\r\n          collaboration and analytics.\r\n        </footer>\r\n\r\n        {/* Composer Modal */}\r\n        {composerOpen && (\r\n          <ComposerModal\r\n            onClose={closeComposer}\r\n            onSent={() => {\r\n              closeComposer();\r\n            }}\r\n            onSend={async (p) => {\r\n              // the ComposerModal now supplies to, channel, body and contactId\r\n              const payload = {\r\n                to: p.to,\r\n                channel: p.channel,\r\n                body: p.body,\r\n                scheduleAt: p.scheduleAt,\r\n                threadId: composerContext?.threadId,\r\n                contactId: p.contactId ?? composerContext?.contactId,\r\n              };\r\n              return sendMessage(payload);\r\n            }}\r\n            context={composerContext}\r\n            contacts={contacts}\r\n          />\r\n        )}\r\n\r\n        {/* Contact modal */}\r\n        {contactModal && (\r\n          <ContactProfileModal contactId={contactModal.contactId} onClose={() => setContactModal(null)} isEditor={isEditor} />\r\n        )}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\n/* ----------------------------- Small components ---------------------------- */\r\n\r\nfunction FeatureCard({ title, desc }: { title: string; desc: string }) {\r\n  return (\r\n    <div className=\"bg-white rounded-xl p-4 shadow-sm border border-slate-100 flex items-start gap-4\">\r\n      <div className=\"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center\">\r\n        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden>\r\n          <path d=\"M4 7h16M4 12h10M4 17h7\" stroke=\"#0f172a\" strokeWidth=\"1.6\" strokeLinecap=\"round\" />\r\n        </svg>\r\n      </div>\r\n      <div>\r\n        <div className=\"text-sm font-semibold text-slate-800\">{title}</div>\r\n        <div className=\"text-xs text-slate-500 mt-1\">{desc}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ThreadsList({ threads, onOpenContact, onCompose }: { threads: any[]; onOpenContact: (id: string) => void; onCompose?: (t?: any) => void }) {\r\n  if (!Array.isArray(threads) || threads.length === 0) {\r\n    return <div className=\"p-6 text-sm text-slate-500\">No recent threads yet.</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"divide-y\">\r\n      {threads.map((t) => {\r\n        // dev-only logging for malformed objects\r\n        if (process.env.NODE_ENV !== \"production\") {\r\n          if (t && !Array.isArray(t.channels)) {\r\n            // eslint-disable-next-line no-console\r\n            console.debug(\"ThreadsList: thread has missing/invalid channels field:\", t);\r\n          }\r\n        }\r\n\r\n        const contactPhone = t?.contactPhone ?? \"—\";\r\n        const channelsDisplay = (Array.isArray(t?.channels) ? t.channels : []).join(\" • \") || \"—\";\r\n        const lastAtDisplay = t?.lastAt ? new Date(t.lastAt).toLocaleString() : \"—\";\r\n        const snippet = t?.snippet ?? \"\";\r\n\r\n        return (\r\n          <div key={t?.id ?? Math.random()} className=\"p-3 hover:bg-slate-50 flex items-start justify-between gap-4\">\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-start justify-between\">\r\n                <div>\r\n                  <div className=\"font-medium\">{t?.contactName ?? \"Unknown\"}</div>\r\n                  <div className=\"text-xs text-slate-500\">\r\n                    {contactPhone} • {channelsDisplay}\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-xs text-slate-400\">{lastAtDisplay}</div>\r\n              </div>\r\n              <div className=\"mt-2 text-sm text-slate-700\">{snippet}</div>\r\n              {t?.scheduled && <div className=\"mt-2 text-xs text-amber-600\">Scheduled</div>}\r\n            </div>\r\n\r\n            <div className=\"flex flex-col items-end gap-2\">\r\n              <button type=\"button\" onClick={() => onOpenContact(t?.contactId ?? t?.id)} className=\"text-xs px-3 py-1 rounded bg-slate-50\">Profile</button>\r\n              <button type=\"button\" onClick={() => (onCompose ? onCompose(t) : null)} className=\"text-xs px-3 py-1 rounded bg-indigo-600 text-white\">Reply</button>\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nfunction IntegrationsPanel({ numbers }: { numbers: ProviderNumber[] }) {\r\n  return (\r\n    <div className=\"rounded-xl border p-4 bg-white\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <div className=\"text-sm font-semibold\">Integration status</div>\r\n          <div className=\"text-xs text-slate-600\">Connected providers & webhook health</div>\r\n        </div>\r\n        <div className=\"text-xs text-slate-500\">OK</div>\r\n      </div>\r\n\r\n      <div className=\"mt-3 text-sm text-slate-700\">\r\n        Twilio (Sandbox) — Webhook configured\r\n        <div className=\"mt-2 text-xs text-slate-500\">Resend (Email) — Not connected</div>\r\n        <div className=\"mt-2 text-xs text-slate-500\">Available numbers: {numbers.length}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction AnalyticsPanel({ analytics, loading }: { analytics: AnalyticsSummary | null; loading: boolean }) {\r\n  return (\r\n    <div className=\"bg-white rounded-2xl p-4 shadow-sm border border-slate-100\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h3 className=\"text-sm font-semibold text-slate-700\">Last 7 days</h3>\r\n        <span className=\"text-xs text-slate-500\">{loading ? \"Loading…\" : \"Updated\"}</span>\r\n      </div>\r\n\r\n      <div className=\"mt-3\">\r\n        <div className=\"flex items-end gap-6\">\r\n          <div>\r\n            <div className=\"text-2xl font-bold\">{analytics?.messages7d ?? \"—\"}</div>\r\n            <div className=\"text-xs text-slate-500\">Messages</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-2xl font-bold\">{analytics?.avgResponseMins ?? \"—\"}m</div>\r\n            <div className=\"text-xs text-slate-500\">Avg response</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-2xl font-bold\">{analytics?.openRatePct ?? \"—\"}%</div>\r\n            <div className=\"text-xs text-slate-500\">Open rate</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-4\">\r\n          <Sparkline data={analytics?.sparkline ?? [1, 2, 3, 2, 4]} />\r\n        </div>\r\n\r\n        <div className=\"mt-4 text-xs text-slate-500\">View full analytics for channel breakdown, response time histograms, and exportable reports.</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------------- Contact modal + Yjs notes ---------------------------- */\r\n\r\nfunction ContactProfileModal({ contactId, onClose, isEditor }: { contactId: string; onClose: () => void; isEditor: boolean }) {\r\n  const [loading, setLoading] = useState(true);\r\n  const [contact, setContact] = useState<any | null>(null);\r\n  const [notes, setNotes] = useState<any[]>([]);\r\n  const [adding, setAdding] = useState(false);\r\n  const [noteText, setNoteText] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    const controller = new AbortController();\r\n    const signal = controller.signal;\r\n\r\n    async function load() {\r\n      try {\r\n        const [cRes, nRes] = await Promise.all([\r\n          fetch(`/api/contacts/${contactId}`, { signal }),\r\n          fetch(`/api/contacts/${contactId}/notes`, { signal }),\r\n        ]);\r\n        if (!mounted) return;\r\n        if (cRes.ok) {\r\n          const cj = await cRes.json();\r\n          setContact(cj.contact ?? cj);\r\n        }\r\n        if (nRes.ok) {\r\n          const nj = await nRes.json();\r\n          setNotes(Array.isArray(nj) ? nj : (nj.notes || []));\r\n        }\r\n      } catch (e) {\r\n        if ((e as any).name !== \"AbortError\") console.error(e);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n\r\n    load();\r\n    return () => {\r\n      mounted = false;\r\n      controller.abort();\r\n    };\r\n  }, [contactId]);\r\n\r\n  async function handleAddNote() {\r\n    if (!noteText.trim()) return;\r\n    setAdding(true);\r\n    try {\r\n      const res = await fetch(`/api/contacts/${contactId}/notes`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ body: noteText }),\r\n      });\r\n      if (!res.ok) throw new Error(\"failed to add note\");\r\n      const j = await res.json();\r\n      setNotes((s) => [j, ...s]);\r\n      setNoteText(\"\");\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(\"Failed to add note\");\r\n    } finally {\r\n      setAdding(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n      <div className=\"absolute inset-0 bg-black/40\" onClick={onClose} />\r\n      <div className=\"relative max-w-3xl w-full bg-white rounded-2xl p-6 shadow-lg z-10\">\r\n        <div className=\"flex items-start justify-between\">\r\n          <h3 className=\"text-lg font-semibold\">Contact profile</h3>\r\n          <button type=\"button\" onClick={onClose} className=\"text-sm text-slate-500\">Close</button>\r\n        </div>\r\n\r\n        {loading ? (\r\n          <div className=\"mt-4\">Loading…</div>\r\n        ) : (\r\n          <div className=\"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div className=\"md:col-span-2\">\r\n              <div className=\"text-sm font-semibold\">{contact?.name ?? contact?.phone ?? \"Contact\"}</div>\r\n              <div className=\"text-xs text-slate-500 mt-1\">{contact?.email ?? \"—\"}</div>\r\n\r\n              <div className=\"mt-4\">\r\n                <div className=\"text-sm font-medium\">Notes (shared)</div>\r\n                <div className=\"mt-2\">\r\n                  <YjsNotes contactId={contactId} currentUser={{ id: \"me\", name: contact?.name ?? \"You\" }} />\r\n                </div>\r\n\r\n                <div className=\"mt-4\">\r\n                  <div className=\"text-sm font-medium\">Saved notes</div>\r\n                  <div className=\"mt-2 space-y-2\">\r\n                    {notes.length === 0 ? (\r\n                      <div className=\"text-xs text-slate-500\">No notes</div>\r\n                    ) : (\r\n                      notes.map((n) => (\r\n                        <div key={n.id} className=\"p-2 bg-slate-50 rounded\">{n.encrypted ? \"(encrypted)\" : n.body}</div>\r\n                      ))\r\n                    )}\r\n                  </div>\r\n\r\n                  {isEditor && (\r\n                    <div className=\"mt-4\">\r\n                      <textarea className=\"w-full rounded border px-3 py-2 mt-1\" rows={3} value={noteText} onChange={(e) => setNoteText(e.target.value)} placeholder=\"Add private note\" />\r\n                      <div className=\"mt-2 flex justify-end\">\r\n                        <button type=\"button\" onClick={handleAddNote} disabled={adding || !noteText.trim()} className=\"px-3 py-1 rounded bg-blue-600 text-white text-sm\">{adding ? \"Adding…\" : \"Add note\"}</button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"md:col-span-1\">\r\n              <div className=\"text-sm font-medium\">Quick actions</div>\r\n              <div className=\"mt-2 flex flex-col gap-2\">\r\n                <Link href={`/inbox?contact=${contactId}`} className=\"px-3 py-2 rounded bg-blue-600 text-white text-sm text-center\">Open thread</Link>\r\n                <button type=\"button\" className=\"px-3 py-2 rounded bg-slate-50 text-sm\">Merge duplicates</button>\r\n                <button type=\"button\" className=\"px-3 py-2 rounded bg-slate-50 text-sm\">Export contact</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------------- Composer (send + schedule) ---------------------------- */\r\n\r\n/**\r\n * ComposerModal props:\r\n * - contacts: preloaded contacts array (used to populate the \"To\" selector)\r\n * - context.contactId: optional contact to pre-select\r\n */\r\nfunction ComposerModal({\r\n  onClose,\r\n  onSent,\r\n  onSend,\r\n  context,\r\n  contacts,\r\n}: {\r\n  onClose: () => void;\r\n  onSent?: (p?: any) => void;\r\n  onSend: (payload: { to: string; channel: string; body: string; scheduleAt?: string; contactId?: string }) => Promise<any>;\r\n  context?: { threadId?: string; contactId?: string } | null;\r\n  contacts: ContactItem[];\r\n}) {\r\n  // `to` state holds the selected actual address (phone or email) string\r\n  const [to, setTo] = useState<string>(\"\");\r\n  // `selectedContactId` stores which contact is selected (if any)\r\n  const [selectedContactId, setSelectedContactId] = useState<string | undefined>(undefined);\r\n\r\n  // channel selection\r\n  const [channel, setChannel] = useState<\"SMS\" | \"WHATSAPP\" | \"EMAIL\">(\"SMS\");\r\n\r\n  const [body, setBody] = useState(\"\");\r\n  const [sending, setSending] = useState(false);\r\n  const [sendMode, setSendMode] = useState<\"now\" | \"schedule\">(\"now\");\r\n  const [sendAt, setSendAt] = useState<string | null>(null);\r\n\r\n  // Keep a local filtered list derived from contacts\r\n  const phoneOptions = useMemo(\r\n    () =>\r\n      contacts\r\n        .filter((c) => c.phone && c.phoneVerified)\r\n        .map((c) => ({ contactId: c.id, label: `${c.name ?? c.phone} (${c.phone})`, value: c.phone })),\r\n    [contacts]\r\n  );\r\n\r\n  const emailOptions = useMemo(\r\n    () =>\r\n      contacts\r\n        .filter((c) => c.email && (c.emailVerified ?? true)) // if backend doesn't provide emailVerified, include if email exists\r\n        .map((c) => ({ contactId: c.id, label: `${c.name ?? c.email} (${c.email})`, value: c.email })),\r\n    [contacts]\r\n  );\r\n\r\n  // If composer opened with context.contactId, pre-select sensible default based on channel\r\n  useEffect(() => {\r\n    if (!context?.contactId) return;\r\n    const c = contacts.find((x) => x.id === context.contactId);\r\n    if (!c) return;\r\n\r\n    if ((channel === \"SMS\" || channel === \"WHATSAPP\") && c.phone) {\r\n      if (c.phoneVerified) {\r\n        setTo(c.phone);\r\n        setSelectedContactId(c.id);\r\n      } else {\r\n        // don't prefill unverified number — leave selection blank\r\n      }\r\n    } else if (channel === \"EMAIL\" && c.email) {\r\n      setTo(c.email);\r\n      setSelectedContactId(c.id);\r\n    } else {\r\n      // if channel doesn't match contact's preferred, try to pick a best-match\r\n      if (channel === \"EMAIL\" && c.email) {\r\n        setTo(c.email);\r\n        setSelectedContactId(c.id);\r\n      } else if ((channel === \"SMS\" || channel === \"WHATSAPP\") && c.phone) {\r\n        if (c.phoneVerified) {\r\n          setTo(c.phone);\r\n          setSelectedContactId(c.id);\r\n        }\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [context?.contactId, contacts, channel]);\r\n\r\n  // When channel changes, clear selection if it no longer matches\r\n  useEffect(() => {\r\n    if (!to) return;\r\n    const isPhoneChannel = channel === \"SMS\" || channel === \"WHATSAPP\";\r\n    const contactHasMatch = contacts.find((c) => {\r\n      if (isPhoneChannel) return c.phone === to && c.phoneVerified;\r\n      else return c.email === to;\r\n    });\r\n    if (!contactHasMatch) {\r\n      // clear selection — forces user to pick a valid contact for the channel\r\n      setTo(\"\");\r\n      setSelectedContactId(undefined);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [channel]);\r\n\r\n  // Handler when user picks an item from the select\r\n  function onSelectTo(e: React.ChangeEvent<HTMLSelectElement>) {\r\n    const val = e.target.value;\r\n    if (!val) {\r\n      setTo(\"\");\r\n      setSelectedContactId(undefined);\r\n      return;\r\n    }\r\n\r\n    // The option value is encoded as JSON: {contactId, value}\r\n    try {\r\n      const parsed = JSON.parse(val);\r\n      setTo(parsed.value);\r\n      setSelectedContactId(parsed.contactId);\r\n    } catch (err) {\r\n      // fallback: plain value\r\n      setTo(val);\r\n      setSelectedContactId(undefined);\r\n    }\r\n  }\r\n  // --- paste here, before your component ---\r\nasync function debugSendMessage(payload: {\r\n  to: string;\r\n  channel: string;\r\n  body: string;\r\n  scheduleAt?: string;\r\n  threadId?: string;\r\n  contactId?: string;\r\n}) {\r\n  try {\r\n    const res = await fetch(\"/api/messages/send\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(payload),\r\n      credentials: \"include\",\r\n    });\r\n\r\n    let body: any = null;\r\n    try {\r\n      body = await res.json().catch(() => null);\r\n    } catch {\r\n      body = null;\r\n    }\r\n\r\n    if (!res.ok) {\r\n      console.error(\r\n        \"send failed:\",\r\n        res.status,\r\n        body ?? (await res.text().catch(() => \"(no body)\"))\r\n      );\r\n      const msg =\r\n        (body && (body.error || body.message)) ||\r\n        `Send failed (HTTP ${res.status}). See console for details.`;\r\n      throw new Error(msg);\r\n    }\r\n\r\n    return body;\r\n  } catch (err: any) {\r\n    console.error(\"send failed (network/internal):\", err);\r\n    throw err;\r\n  }\r\n}\r\n\r\n\r\n  async function handleSend() {\r\n    setSending(true);\r\n    try {\r\n      // ensure required fields\r\n      if (!to) {\r\n        alert(\"Select a recipient in the To field.\");\r\n        setSending(false);\r\n        return;\r\n      }\r\n      if (!body.trim()) {\r\n        alert(\"Message body is required.\");\r\n        setSending(false);\r\n        return;\r\n      }\r\n\r\n      const payload = {\r\n        to,\r\n        channel,\r\n        body,\r\n        scheduleAt: sendMode === \"schedule\" && sendAt ? sendAt : undefined,\r\n        contactId: selectedContactId,\r\n      };\r\n      await onSend(payload);\r\n      onSent?.(payload);\r\n      onClose();\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(\"Failed to send message\");\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  }\r\n\r\n  // Build the options list for current channel\r\n  const currentOptions = useMemo(() => {\r\n    if (channel === \"EMAIL\") {\r\n      // include email options\r\n      return emailOptions.map((o) => ({ label: o.label, value: JSON.stringify({ contactId: o.contactId, value: o.value }) }));\r\n    } else {\r\n      // SMS or WHATSAPP -> phones only\r\n      return phoneOptions.map((o) => ({ label: o.label, value: JSON.stringify({ contactId: o.contactId, value: o.value }) }));\r\n    }\r\n  }, [channel, phoneOptions, emailOptions]);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n      <div className=\"absolute inset-0 bg-black/40\" onClick={onClose} />\r\n      <div className=\"relative max-w-2xl w-full bg-white rounded-2xl p-6 shadow-lg z-10\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h3 className=\"text-lg font-semibold\">Compose message</h3>\r\n          <button type=\"button\" onClick={onClose} className=\"text-sm text-slate-500\">Close</button>\r\n        </div>\r\n\r\n        <div className=\"mt-4 space-y-3\">\r\n          <div>\r\n            <label className=\"text-xs text-slate-600\">To</label>\r\n\r\n            {/* SELECT field (required) */}\r\n            <select\r\n              className=\"w-full rounded border px-3 py-2 mt-1\"\r\n              value={to ? JSON.stringify({ contactId: selectedContactId ?? null, value: to }) : \"\"}\r\n              onChange={onSelectTo}\r\n            >\r\n              <option value=\"\">— select recipient —</option>\r\n              {currentOptions.length === 0 ? (\r\n                <option value=\"\" disabled>\r\n                  No verified recipients for {channel === \"EMAIL\" ? \"email\" : \"phone/WhatsApp\"}\r\n                </option>\r\n              ) : (\r\n                currentOptions.map((opt, i) => (\r\n                  <option key={i} value={opt.value}>\r\n                    {opt.label}\r\n                  </option>\r\n                ))\r\n              )}\r\n            </select>\r\n\r\n            <div className=\"text-xs text-slate-400 mt-1\">\r\n              Choose a verified recipient. For {channel === \"EMAIL\" ? \"emails\" : \"phones/WhatsApp\"}, only verified addresses are shown.\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            <div>\r\n              <label className=\"text-xs text-slate-600\">Channel</label>\r\n              <select className=\"w-full rounded border px-3 py-2 mt-1\" value={channel} onChange={(e) => setChannel(e.target.value as any)}>\r\n                <option value=\"SMS\">SMS</option>\r\n                <option value=\"WHATSAPP\">WhatsApp</option>\r\n                <option value=\"EMAIL\">Email</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-xs text-slate-600\">Send</label>\r\n              <select className=\"w-full rounded border px-3 py-2 mt-1\" value={sendMode} onChange={(e) => setSendMode(e.target.value as any)}>\r\n                <option value=\"now\">Send now</option>\r\n                <option value=\"schedule\">Schedule</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {sendMode === \"schedule\" && (\r\n            <div>\r\n              <label className=\"text-xs text-slate-600\">Send at</label>\r\n              <input className=\"w-full rounded border px-3 py-2 mt-1\" type=\"datetime-local\" value={sendAt ?? \"\"} onChange={(e) => setSendAt(e.target.value)} />\r\n              <div className=\"text-xs text-slate-400 mt-1\">Scheduled messages will be executed by the scheduler worker at the selected time.</div>\r\n            </div>\r\n          )}\r\n\r\n          <div>\r\n            <label className=\"text-xs text-slate-600\">Message</label>\r\n            <textarea className=\"w-full rounded border px-3 py-2 mt-1\" rows={4} value={body} onChange={(e) => setBody(e.target.value)} />\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <button type=\"button\" onClick={onClose} className=\"px-4 py-2 rounded border\">Cancel</button>\r\n            <button type=\"button\" onClick={handleSend} disabled={sending || !to || !body} className=\"px-4 py-2 rounded bg-indigo-600 text-white\">\r\n              {sending ? \"Sending…\" : sendMode === \"now\" ? \"Send\" : \"Schedule\"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------------- YjsNotes (lightweight) ---------------------------- */\r\n\r\nfunction YjsNotes({ contactId, currentUser }: { contactId: string; currentUser: { id?: string; name?: string } }) {\r\n  const [text, setText] = useState(\"\");\r\n  const ydocRef = useRef<Y.Doc | null>(null);\r\n  const providerRef = useRef<WebsocketProvider | null>(null);\r\n\r\n  useEffect(() => {\r\n    const wsUrl = process.env.NEXT_PUBLIC_YJS_WS || \"ws://localhost:1234\";\r\n    const doc = new Y.Doc();\r\n    ydocRef.current = doc;\r\n    const provider = new WebsocketProvider(wsUrl, `contact-notes-${contactId}`, doc);\r\n    providerRef.current = provider;\r\n\r\n    const ytext = doc.getText(\"notes\");\r\n    setText(ytext.toString());\r\n    const obs = () => setText(ytext.toString());\r\n    ytext.observe(obs);\r\n\r\n    provider.awareness.setLocalStateField(\"user\", { id: currentUser?.id, name: currentUser?.name ?? \"Unknown\" });\r\n\r\n    return () => {\r\n      try {\r\n        ytext.unobserve(obs);\r\n      } catch (e) {}\r\n      try {\r\n        provider.disconnect();\r\n      } catch (e) {}\r\n      doc.destroy();\r\n    };\r\n  }, [contactId, currentUser?.id, currentUser?.name]);\r\n\r\n  function onChangeLocal(e: React.ChangeEvent<HTMLTextAreaElement>) {\r\n    const doc = ydocRef.current;\r\n    if (!doc) return;\r\n    const ytext = doc.getText(\"notes\");\r\n    // replace entire text (simple approach)\r\n    ytext.delete(0, ytext.length);\r\n    ytext.insert(0, e.target.value);\r\n    setText(e.target.value);\r\n  }\r\n\r\n  async function saveSnapshotToDB() {\r\n    const doc = ydocRef.current;\r\n    if (!doc) return;\r\n    const ytext = doc.getText(\"notes\");\r\n    const val = ytext.toString();\r\n    try {\r\n      await fetch(`/api/contacts/${contactId}/notes`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ body: val }),\r\n      });\r\n      alert(\"Saved note snapshot\");\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(\"Failed to save\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <textarea className=\"w-full rounded border px-3 py-2 mt-1\" rows={6} value={text} onChange={onChangeLocal} />\r\n      <div className=\"flex justify-end mt-2 gap-2\">\r\n        <button onClick={saveSnapshotToDB} className=\"px-3 py-1 rounded bg-slate-50\">Save snapshot</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ----------------------------- Sparkline ---------------------------- */\r\n\r\nfunction Sparkline({ data }: { data: number[] }) {\r\n  const width = 160;\r\n  const height = 40;\r\n  const max = Math.max(...data);\r\n  const min = Math.min(...data);\r\n  const points = data\r\n    .map((v, i) => {\r\n      const x = (i / (data.length - 1 || 1)) * width;\r\n      const y = height - ((v - min) / (max - min || 1)) * height;\r\n      return `${x},${y}`;\r\n    })\r\n    .join(\" \");\r\n\r\n  return (\r\n    <svg width={width} height={height} viewBox={`0 0 ${width} ${height}`} aria-hidden>\r\n      <polyline\r\n        fill=\"none\"\r\n        stroke=\"#4F46E5\"\r\n        strokeWidth={2}\r\n        strokeLinejoin=\"round\"\r\n        strokeLinecap=\"round\"\r\n        points={points}\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n"],"names":["c","_c","React","useEffect","useMemo","useRef","useState","Link","useRouter","ProfileMenu","Y","WebsocketProvider","Role","User","id","email","name","role","tenantId","AnalyticsSummary","messages7d","avgResponseMins","openRatePct","sparkline","ThreadPreviewItem","contactId","contactName","contactPhone","channels","snippet","lastAt","unreadCount","status","scheduled","ProviderNumber","phone","provider","capabilities","Record","purchased","ContactItem","emailVerified","phoneVerified","WelcomePage","router","user","setUser","loading","setLoading","analytics","setAnalytics","threads","setThreads","numbers","setNumbers","contacts","setContacts","composerOpen","setComposerOpen","composerContext","setComposerContext","threadId","contactModal","setContactModal","buying","setBuying","presence","setPresence","idle","wsRef","WebSocket","toString","toUpperCase","isAdmin","isEditor","mounted","controller","AbortController","signal","loadAll","meRes","analyticsRes","threadsRes","numbersRes","Promise","all","fetch","ok","j","json","err","console","warn","Array","isArray","length","e","fetchContacts","error","abort","AbortSignal","tried","normalizeRaw","raw","userId","_id","displayName","fullName","profile","Boolean","email_verified","emails","primary","find","value","address","verified","verifiedAt","accounts","acct","a","identities","idn","phone_verified","phoneNumber","phones","p","number","String","Math","random","slice","tryFetch","url","push","opts","undefined","r","debug","catch","tries","aggregated","data","n","item","users","items","me","map","Map","key","JSON","stringify","has","set","ex","get","result","from","values","prev","mergeUniqueContacts","next","forEach","existing","ws","window","location","origin","current","onopen","send","type","onmessage","ev","msg","parse","copy","t","thread","x","onclose","close","handlePrimary","handleBuyNumber","res","method","headers","body","Error","refreshed","alert","openComposer","ctx","closeComposer","sendMessage","payload","to","channel","scheduleAt","isScheduled","optimistic","Date","toISOString","Response","endpoint","sendAt","metadata","text","parsed","filter","startsWith","serverMsg","message","Object","keys","entries","k","join","FeatureCard","t0","$","$i","Symbol","for","title","desc","t1","t2","t3","t4","ThreadsList","onOpenContact","onCompose","process","env","NODE_ENV","channelsDisplay","lastAtDisplay","toLocaleString","ThreadsList[threads.map() > <button>.onClick]","IntegrationsPanel","AnalyticsPanel","t5","t6","t7","t8","t9","t10","t11","t12","t13","t14","t15","t16","t17","t18","t19","t20","t21","ContactProfileModal","onClose","contact","setContact","notes","setNotes","adding","setAdding","noteText","setNoteText","load","cRes","nRes","cj","nj","handleAddNote","trim","s","encrypted","target","ComposerModal","onSent","onSend","context","setTo","selectedContactId","setSelectedContactId","setChannel","setBody","sending","setSending","sendMode","setSendMode","setSendAt","phoneOptions","label","emailOptions","isPhoneChannel","contactHasMatch","onSelectTo","ChangeEvent","HTMLSelectElement","val","debugSendMessage","credentials","handleSend","currentOptions","o","opt","i","YjsNotes","currentUser","setText","ydocRef","providerRef","YjsNotes[useEffect()]","wsUrl","NEXT_PUBLIC_YJS_WS","doc","Doc","ytext","getText","obs","YjsNotes[useEffect() > obs]","observe","awareness","setLocalStateField","unobserve","disconnect","destroy","onChangeLocal","e_1","doc_0","ytext_0","delete","insert","saveSnapshotToDB","doc_1","ytext_1","Sparkline","max","min","Sparkline[data.map()]","v","y","points","width","height"],"mappings":"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","ignoreList":[],"debugId":null}}]
}