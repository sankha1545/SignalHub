{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/SignalHub/frontend/src/app/api/auth/reset-pass/reset/route.ts"],"sourcesContent":["// app/api/auth/forgot/reset/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\n/**\r\n * Mock reset:\r\n * - Accepts { email, password }\r\n * - Validate inputs\r\n * - In production:\r\n *   - Verify server-side that the user has a valid verified OTP or short-lived reset token\r\n *   - Hash the password (bcrypt / argon2) and update DB\r\n *   - Record last_password_change timestamp (DB) to enforce 24h lockout (server-side)\r\n */\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const body = await req.json();\r\n    const email = String(body?.email ?? \"\").trim().toLowerCase();\r\n    const password = String(body?.password ?? \"\");\r\n\r\n    if (!email || !/^\\S+@\\S+\\.\\S+$/.test(email)) {\r\n      return NextResponse.json({ error: \"Invalid email\" }, { status: 400 });\r\n    }\r\n    if (!password || password.length < 8) {\r\n      return NextResponse.json({ error: \"Password must be at least 8 characters\" }, { status: 400 });\r\n    }\r\n\r\n    // TODO: verify OTP verification from previous step (server-side).\r\n    // TODO: lookup user in DB. If not found, return 404 or generic success based on UX policy.\r\n    // TODO: hash password and update DB, store last_password_change timestamp.\r\n\r\n    console.log(`[DEV] Password for ${email} changed (mock).`);\r\n\r\n    return NextResponse.json({ ok: true, message: \"Password changed (dev-mode)\" }, { status: 200 });\r\n  } catch (err) {\r\n    console.error(\"reset error\", err);\r\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;;AACrC;;AAaO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,QAAQ,OAAO,MAAM,SAAS,IAAI,IAAI,GAAG,WAAW;QAC1D,MAAM,WAAW,OAAO,MAAM,YAAY;QAE1C,IAAI,CAAC,SAAS,CAAC,iBAAiB,IAAI,CAAC,QAAQ;YAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QACA,IAAI,CAAC,YAAY,SAAS,MAAM,GAAG,GAAG;YACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyC,GAAG;gBAAE,QAAQ;YAAI;QAC9F;QAEA,kEAAkE;QAClE,2FAA2F;QAC3F,2EAA2E;QAE3E,QAAQ,GAAG,CAAC,CAAC,mBAAmB,EAAE,MAAM,gBAAgB,CAAC;QAEzD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,SAAS;QAA8B,GAAG;YAAE,QAAQ;QAAI;IAC/F,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,eAAe;QAC7B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}