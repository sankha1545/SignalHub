{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attackcapital/SignalHub/frontend/src/app/api/phone/send-otp/route.ts"],"sourcesContent":["// app/api/phone/send-otp/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport { PrismaClient } from \"@prisma/client\";\r\n\r\nconst prisma = new PrismaClient();\r\n// simple in-memory store for dev only\r\nconst OTP_STORE: Record<string, { otp: string; expiresAt: number }> = {};\r\n\r\nfunction genOtp(len = 4) {\r\n  return Math.random().toString().slice(2, 2 + len).padEnd(len, \"0\");\r\n}\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json().catch(() => ({}));\r\n    const phone = (body?.phone || \"\").toString();\r\n    if (!phone) return NextResponse.json({ error: \"phone_required\" }, { status: 400 });\r\n\r\n    const otpLen = Number(body?.otpLen || 4);\r\n    const otp = genOtp(otpLen);\r\n    const expiresAt = Date.now() + 5 * 60 * 1000;\r\n\r\n    // store\r\n    OTP_STORE[phone] = { otp, expiresAt };\r\n\r\n    // In dev, log OTP so you can test without SMS provider\r\n    console.log(`[DEV OTP] phone=${phone} otp=${otp} expiresAt=${new Date(expiresAt).toISOString()}`);\r\n\r\n    // optionally: send via Twilio/SMS here\r\n    // await twilioClient.messages.create({from: TWILIO_FROM, to: phone, body: `Your OTP: ${otp}`})\r\n\r\n    return NextResponse.json({ ok: true, phone, debugOtp: otp }); // debugOtp only for dev\r\n  } catch (err) {\r\n    console.error(\"send-otp error\", err);\r\n    return NextResponse.json({ error: \"internal\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;AAClC;AACA;;;AAEA,MAAM,SAAS,IAAI,6IAAY;AAC/B,sCAAsC;AACtC,MAAM,YAAgE,CAAC;AAEvE,SAAS,OAAO,MAAM,CAAC;IACrB,OAAO,KAAK,MAAM,GAAG,QAAQ,GAAG,KAAK,CAAC,GAAG,IAAI,KAAK,MAAM,CAAC,KAAK;AAChE;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QAC7C,MAAM,QAAQ,CAAC,MAAM,SAAS,EAAE,EAAE,QAAQ;QAC1C,IAAI,CAAC,OAAO,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;QAEhF,MAAM,SAAS,OAAO,MAAM,UAAU;QACtC,MAAM,MAAM,OAAO;QACnB,MAAM,YAAY,KAAK,GAAG,KAAK,IAAI,KAAK;QAExC,QAAQ;QACR,SAAS,CAAC,MAAM,GAAG;YAAE;YAAK;QAAU;QAEpC,uDAAuD;QACvD,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,MAAM,KAAK,EAAE,IAAI,WAAW,EAAE,IAAI,KAAK,WAAW,WAAW,IAAI;QAEhG,uCAAuC;QACvC,+FAA+F;QAE/F,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;YAAO,UAAU;QAAI,IAAI,wBAAwB;IACxF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAW,GAAG;YAAE,QAAQ;QAAI;IAChE;AACF","debugId":null}}]
}