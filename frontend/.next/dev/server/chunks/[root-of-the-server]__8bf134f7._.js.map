{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/SignalHub/frontend/src/app/api/auth/reset-pass/verify-otp/route.ts"],"sourcesContent":["// app/api/auth/reset-pass/verify-otp/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\nconst OTP_STORE = (global as any).__RESET_PASS_OTP_STORE__;\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const { email, code } = await req.json();\r\n    const normalized = String(email ?? \"\").trim().toLowerCase();\r\n    const codestr = String(code ?? \"\").trim();\r\n\r\n    if (!normalized || !codestr) {\r\n      return NextResponse.json({ error: \"Missing email or code\" }, { status: 400 });\r\n    }\r\n\r\n    const entry = OTP_STORE?.get(normalized);\r\n    if (!entry) return NextResponse.json({ error: \"No OTP found\" }, { status: 404 });\r\n\r\n    if (Date.now() > entry.expiresAt) {\r\n      OTP_STORE.delete(normalized);\r\n      return NextResponse.json({ error: \"OTP expired\" }, { status: 410 });\r\n    }\r\n\r\n    if (entry.code !== codestr) return NextResponse.json({ error: \"Invalid OTP\" }, { status: 400 });\r\n\r\n    // single-use: remove OTP\r\n    OTP_STORE.delete(normalized);\r\n\r\n    return NextResponse.json({ ok: true, message: \"OTP verified\" }, { status: 200 });\r\n  } catch (err) {\r\n    console.error(\"verify-otp error\", err);\r\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,8CAA8C;;;;;AAC9C;;AAGA,MAAM,YAAY,yDAAgB,wBAAwB;AAEnD,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QACtC,MAAM,aAAa,OAAO,SAAS,IAAI,IAAI,GAAG,WAAW;QACzD,MAAM,UAAU,OAAO,QAAQ,IAAI,IAAI;QAEvC,IAAI,CAAC,cAAc,CAAC,SAAS;YAC3B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,MAAM,QAAQ,WAAW,IAAI;QAC7B,IAAI,CAAC,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;QAE9E,IAAI,KAAK,GAAG,KAAK,MAAM,SAAS,EAAE;YAChC,UAAU,MAAM,CAAC;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAc,GAAG;gBAAE,QAAQ;YAAI;QACnE;QAEA,IAAI,MAAM,IAAI,KAAK,SAAS,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAc,GAAG;YAAE,QAAQ;QAAI;QAE7F,yBAAyB;QACzB,UAAU,MAAM,CAAC;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;IAChF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}